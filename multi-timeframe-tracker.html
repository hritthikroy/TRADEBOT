<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Timeframe Signal Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #0d1117;
            color: #c9d1d9;
            padding: 20px;
        }
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        h1 {
            text-align: center;
            color: #58a6ff;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #8b949e;
            margin-bottom: 30px;
        }
        .controls {
            background: #161b22;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        label {
            font-size: 12px;
            color: #8b949e;
        }
        select, input {
            padding: 8px 12px;
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            color: #c9d1d9;
            font-size: 14px;
        }
        .timeframe-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .timeframe-panel {
            background: #161b22;
            border: 2px solid #30363d;
            border-radius: 8px;
            padding: 15px;
            transition: border-color 0.3s;
        }
        .timeframe-panel:hover {
            border-color: #58a6ff;
        }
        .timeframe-panel.active {
            border-color: #3fb950;
            box-shadow: 0 0 20px rgba(63, 185, 80, 0.2);
        }
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #21262d;
        }
        .panel-title {
            font-size: 20px;
            font-weight: 700;
        }
        .tf-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
        }
        .tf-2h { color: #f85149; }
        .tf-1m { color: #ffa657; }
        .tf-3m { color: #ff7b72; }
        .tf-15m { color: #58a6ff; }
        .signal-list {
            max-height: 300px;
            overflow-y: auto;
        }
        .signal-card {
            background: #0d1117;
            border: 1px solid #30363d;
            border-radius: 6px;
            padding: 12px;
            margin-bottom: 10px;
        }
        .signal-card.buy {
            border-left: 4px solid #3fb950;
        }
        .signal-card.sell {
            border-left: 4px solid #f85149;
        }
        .signal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }
        .signal-type {
            font-size: 16px;
            font-weight: 700;
        }
        .signal-type.buy { color: #3fb950; }
        .signal-type.sell { color: #f85149; }
        .signal-time {
            font-size: 11px;
            color: #8b949e;
        }
        .signal-details {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            font-size: 12px;
        }
        .signal-detail {
            display: flex;
            justify-content: space-between;
        }
        .signal-label {
            color: #8b949e;
        }
        .signal-value {
            font-weight: 600;
        }
        .no-signals {
            text-align: center;
            padding: 40px;
            color: #8b949e;
        }
        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .stat-box {
            background: #0d1117;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
        }
        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #58a6ff;
        }
        .stat-label {
            font-size: 11px;
            color: #8b949e;
            margin-top: 4px;
        }
        button {
            padding: 10px 20px;
            background: #238636;
            border: none;
            border-radius: 6px;
            color: white;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
        }
        button:hover {
            background: #2ea043;
        }
        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-right: 5px;
        }
        .status-active {
            background: #3fb950;
            animation: pulse 2s infinite;
        }
        .status-inactive {
            background: #8b949e;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Multi-Timeframe Signal Tracker</h1>
        <div class="subtitle">Monitor signals across multiple timeframes simultaneously</div>

        <div class="controls">
            <div class="control-group">
                <label>Symbol</label>
                <select id="symbol">
                    <option value="BTCUSDT">BTCUSDT</option>
                    <option value="ETHUSDT">ETHUSDT</option>
                    <option value="BNBUSDT">BNBUSDT</option>
                    <option value="SOLUSDT">SOLUSDT</option>
                </select>
            </div>
            <div class="control-group">
                <label>Update Interval</label>
                <select id="updateInterval">
                    <option value="5000">5 seconds</option>
                    <option value="10000">10 seconds</option>
                    <option value="30000" selected>30 seconds</option>
                    <option value="60000">1 minute</option>
                </select>
            </div>
            <button onclick="startTracking()">‚ñ∂Ô∏è Start Tracking</button>
            <button onclick="stopTracking()">‚è∏Ô∏è Stop</button>
            <button onclick="clearAllSignals()">üóëÔ∏è Clear All</button>
        </div>

        <div class="timeframe-grid" id="timeframeGrid"></div>
    </div>

    <script src="trading-signals.js"></script>
    <script>
        // Top performing timeframes based on backtest
        const timeframes = [
            { tf: '2h', name: '2 Hour', color: '#f85149', return: 1475, pf: 4.09, winRate: 52.4 },
            { tf: '1m', name: '1 Minute', color: '#ffa657', return: 652, pf: 1.97, winRate: 40.0 },
            { tf: '3m', name: '3 Minute', color: '#ff7b72', return: 639, pf: 2.07, winRate: 50.5 },
            { tf: '15m', name: '15 Minute', color: '#58a6ff', return: 563, pf: 2.19, winRate: 63.3 },
            { tf: '8h', name: '8 Hour', color: '#a371f7', return: 427, pf: 1.80, winRate: 55.4 },
            { tf: '12h', name: '12 Hour', color: '#d2a8ff', return: 390, pf: 1.88, winRate: 58.8 }
        ];

        let trackingInterval = null;
        let signalsByTimeframe = {};

        // Initialize
        timeframes.forEach(tf => {
            signalsByTimeframe[tf.tf] = [];
        });

        // Render timeframe panels
        function renderPanels() {
            const grid = document.getElementById('timeframeGrid');
            
            grid.innerHTML = timeframes.map(tf => `
                <div class="timeframe-panel" id="panel-${tf.tf}">
                    <div class="panel-header">
                        <div>
                            <span class="status-indicator status-inactive" id="status-${tf.tf}"></span>
                            <span class="panel-title" style="color: ${tf.color}">${tf.name}</span>
                        </div>
                        <div class="tf-badge" style="background: ${tf.color}; color: white;">
                            ${tf.tf.toUpperCase()}
                        </div>
                    </div>
                    
                    <div class="stats-row">
                        <div class="stat-box">
                            <div class="stat-value" style="color: ${tf.color}">${tf.return}%</div>
                            <div class="stat-label">Return</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">${tf.pf}</div>
                            <div class="stat-label">PF</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">${tf.winRate}%</div>
                            <div class="stat-label">Win Rate</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value" id="count-${tf.tf}">0</div>
                            <div class="stat-label">Signals</div>
                        </div>
                    </div>
                    
                    <div class="signal-list" id="signals-${tf.tf}">
                        <div class="no-signals">No signals yet...</div>
                    </div>
                </div>
            `).join('');
        }

        // Fetch signals for a specific timeframe
        async function fetchSignalsForTimeframe(tf) {
            try {
                const symbol = document.getElementById('symbol').value;
                
                // Store current interval
                const originalInterval = window.currentInterval;
                window.currentInterval = tf;
                
                // Fetch data
                const url = `https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=${tf}&limit=200`;
                const response = await fetch(url);
                const data = await response.json();
                
                if (!Array.isArray(data)) return;
                
                const candles = data.map(c => ({
                    time: c[0],
                    open: parseFloat(c[1]),
                    high: parseFloat(c[2]),
                    low: parseFloat(c[3]),
                    close: parseFloat(c[4]),
                    volume: parseFloat(c[5])
                }));
                
                // Generate signal (simplified - you'd use your full logic)
                if (window.generateTradingSignal && candles.length >= 50) {
                    const aiPrediction = { signal: 'BUY', confidence: 60 };
                    const volumeAnalysis = { volatilityLevel: 'normal' };
                    const mtfTrendFilter = { higherTFTrend: true, confidence: 70 };
                    
                    const signal = window.generateTradingSignal(candles, aiPrediction, volumeAnalysis, mtfTrendFilter);
                    
                    if (signal) {
                        // Add to signals
                        const newSignal = {
                            ...signal,
                            timeframe: tf,
                            timestamp: Date.now(),
                            symbol: symbol
                        };
                        
                        // Check if signal already exists (avoid duplicates)
                        const exists = signalsByTimeframe[tf].some(s => 
                            s.type === newSignal.type && 
                            Math.abs(s.entry - newSignal.entry) < 10
                        );
                        
                        if (!exists) {
                            signalsByTimeframe[tf].unshift(newSignal);
                            // Keep only last 10 signals
                            signalsByTimeframe[tf] = signalsByTimeframe[tf].slice(0, 10);
                            
                            // Mark as active
                            document.getElementById(`status-${tf}`).className = 'status-indicator status-active';
                            document.getElementById(`panel-${tf}`).classList.add('active');
                        }
                    }
                }
                
                // Restore interval
                window.currentInterval = originalInterval;
                
            } catch (error) {
                console.error(`Error fetching ${tf}:`, error);
            }
        }

        // Update display
        function updateDisplay() {
            timeframes.forEach(tf => {
                const signals = signalsByTimeframe[tf.tf];
                const container = document.getElementById(`signals-${tf.tf}`);
                const countEl = document.getElementById(`count-${tf.tf}`);
                
                countEl.textContent = signals.length;
                
                if (signals.length === 0) {
                    container.innerHTML = '<div class="no-signals">No signals yet...</div>';
                    return;
                }
                
                container.innerHTML = signals.map(signal => {
                    const age = Math.floor((Date.now() - signal.timestamp) / 1000 / 60);
                    const ageText = age < 1 ? 'Just now' : age === 1 ? '1 min ago' : `${age} mins ago`;
                    
                    return `
                        <div class="signal-card ${signal.type.toLowerCase()}">
                            <div class="signal-header">
                                <span class="signal-type ${signal.type.toLowerCase()}">${signal.type}</span>
                                <span class="signal-time">${ageText}</span>
                            </div>
                            <div class="signal-details">
                                <div class="signal-detail">
                                    <span class="signal-label">Entry:</span>
                                    <span class="signal-value">${signal.entry.toFixed(2)}</span>
                                </div>
                                <div class="signal-detail">
                                    <span class="signal-label">SL:</span>
                                    <span class="signal-value">${signal.stopLoss.toFixed(2)}</span>
                                </div>
                                <div class="signal-detail">
                                    <span class="signal-label">TP1:</span>
                                    <span class="signal-value">${signal.targets[0].price.toFixed(2)}</span>
                                </div>
                                <div class="signal-detail">
                                    <span class="signal-label">RR:</span>
                                    <span class="signal-value">${signal.bestRR.toFixed(2)}:1</span>
                                </div>
                                <div class="signal-detail">
                                    <span class="signal-label">Confluence:</span>
                                    <span class="signal-value">${signal.confluence || 'N/A'}</span>
                                </div>
                                <div class="signal-detail">
                                    <span class="signal-label">Strength:</span>
                                    <span class="signal-value">${signal.strength}%</span>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            });
        }

        // Start tracking
        async function startTracking() {
            if (trackingInterval) {
                alert('Already tracking!');
                return;
            }
            
            const interval = parseInt(document.getElementById('updateInterval').value);
            
            console.log('üöÄ Starting multi-timeframe tracking...');
            
            // Initial fetch
            for (const tf of timeframes) {
                await fetchSignalsForTimeframe(tf.tf);
                await new Promise(resolve => setTimeout(resolve, 500)); // Delay between requests
            }
            updateDisplay();
            
            // Set interval
            trackingInterval = setInterval(async () => {
                for (const tf of timeframes) {
                    await fetchSignalsForTimeframe(tf.tf);
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
                updateDisplay();
            }, interval);
            
            alert('‚úÖ Tracking started!');
        }

        // Stop tracking
        function stopTracking() {
            if (trackingInterval) {
                clearInterval(trackingInterval);
                trackingInterval = null;
                
                // Reset status indicators
                timeframes.forEach(tf => {
                    document.getElementById(`status-${tf.tf}`).className = 'status-indicator status-inactive';
                    document.getElementById(`panel-${tf.tf}`).classList.remove('active');
                });
                
                alert('‚è∏Ô∏è Tracking stopped');
            }
        }

        // Clear all signals
        function clearAllSignals() {
            if (confirm('Clear all signals?')) {
                timeframes.forEach(tf => {
                    signalsByTimeframe[tf.tf] = [];
                });
                updateDisplay();
            }
        }

        // Initialize
        renderPanels();
        
        console.log('‚úÖ Multi-timeframe tracker ready!');
        console.log('üìä Tracking 6 timeframes: 2h, 1m, 3m, 15m, 8h, 12h');
    </script>
</body>
</html>
