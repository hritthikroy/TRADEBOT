<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strategy Performance Dashboard - Live Paper Trading</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1.1em;
        }

        .controls {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .controls select, .controls input, .controls button {
            padding: 12px 20px;
            border: 2px solid #667eea;
            border-radius: 8px;
            font-size: 1em;
            outline: none;
        }

        .controls button {
            background: #667eea;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .controls button:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }

        .controls button.stop {
            background: #e74c3c;
        }

        .controls button.stop:hover {
            background: #c0392b;
        }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .summary-card h3 {
            color: #666;
            font-size: 0.9em;
            margin-bottom: 10px;
            text-transform: uppercase;
        }

        .summary-card .value {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }

        .summary-card .value.positive {
            color: #27ae60;
        }

        .summary-card .value.negative {
            color: #e74c3c;
        }

        .strategies-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(380px, 1fr));
            gap: 25px;
        }

        .strategy-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
            overflow: hidden;
            transition: all 0.3s;
            position: relative;
        }

        .strategy-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.25);
        }

        .strategy-card.best {
            border: 3px solid #f39c12;
        }

        .strategy-card.best::before {
            content: "üèÜ BEST PERFORMER";
            position: absolute;
            top: 10px;
            right: 10px;
            background: #f39c12;
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.7em;
            font-weight: bold;
            z-index: 10;
        }

        .strategy-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
        }

        .strategy-header h2 {
            font-size: 1.3em;
            margin-bottom: 5px;
        }

        .strategy-header .emoji {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .strategy-header .description {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .strategy-body {
            padding: 20px;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .metric-row:last-child {
            border-bottom: none;
        }

        .metric-label {
            color: #666;
            font-weight: 500;
        }

        .metric-value {
            font-weight: bold;
            color: #333;
        }

        .metric-value.positive {
            color: #27ae60;
        }

        .metric-value.negative {
            color: #e74c3c;
        }

        .status-badge {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: bold;
            margin-top: 10px;
        }

        .status-badge.running {
            background: #27ae60;
            color: white;
        }

        .status-badge.stopped {
            background: #95a5a6;
            color: white;
        }

        .status-badge.profitable {
            background: #2ecc71;
            color: white;
        }

        .status-badge.losing {
            background: #e74c3c;
            color: white;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .action-buttons button {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .btn-start {
            background: #27ae60;
            color: white;
        }

        .btn-start:hover {
            background: #229954;
        }

        .btn-stop {
            background: #e74c3c;
            color: white;
        }

        .btn-stop:hover {
            background: #c0392b;
        }

        .btn-details {
            background: #3498db;
            color: white;
        }

        .btn-details:hover {
            background: #2980b9;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: white;
            font-size: 1.5em;
        }

        .last-update {
            text-align: center;
            color: white;
            margin-top: 20px;
            font-size: 0.9em;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .live-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            background: #27ae60;
            border-radius: 50%;
            margin-right: 5px;
            animation: pulse 2s infinite;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìä Strategy Performance Dashboard</h1>
            <p>Real-time Paper Trading Performance - Find Your Best Strategy!</p>
        </div>

        <div class="controls">
            <select id="symbol">
                <option value="BTCUSDT">BTCUSDT</option>
                <option value="ETHUSDT">ETHUSDT</option>
                <option value="BNBUSDT">BNBUSDT</option>
                <option value="SOLUSDT">SOLUSDT</option>
            </select>

            <select id="interval">
                <option value="5m">5 Minutes</option>
                <option value="15m" selected>15 Minutes</option>
                <option value="1h">1 Hour</option>
                <option value="4h">4 Hours</option>
            </select>

            <input type="number" id="startBalance" value="1000" placeholder="Start Balance">

            <button onclick="startAllStrategies()">üöÄ Start All Strategies</button>
            <button onclick="stopAllStrategies()" class="stop">‚èπÔ∏è Stop All</button>
            <button onclick="refreshData()">üîÑ Refresh</button>
        </div>

        <div class="summary" id="summary">
            <!-- Summary cards will be inserted here -->
        </div>

        <div class="strategies-grid" id="strategiesGrid">
            <div class="loading">Loading strategies...</div>
        </div>

        <div class="last-update" id="lastUpdate">
            <span class="live-indicator"></span>
            Last updated: Never
        </div>
    </div>

    <script>
        const strategies = [
            { id: 'session_trader', name: 'Session Trader Pro', emoji: 'üèÜ', description: 'Best Overall' },
            { id: 'liquidity_hunter', name: 'Liquidity Hunter Elite', emoji: 'üéØ', description: 'Highest Win Rate' },
            { id: 'breakout_master', name: 'Breakout Master V2', emoji: 'üí•', description: 'Explosive Moves' },
            { id: 'trend_rider', name: 'Trend Rider Pro', emoji: 'üìà', description: 'Trend Master' },
            { id: 'scalper_pro', name: 'Scalper Pro Ultra', emoji: '‚ö°', description: 'Rapid Fire' },
            { id: 'reversal_sniper', name: 'Reversal Sniper Elite', emoji: 'üé™', description: 'Reversal King' },
            { id: 'smart_money_tracker', name: 'Smart Money Tracker V2', emoji: 'üè¶', description: 'Institutional' },
            { id: 'momentum_beast', name: 'Momentum Beast Ultra', emoji: 'üöÄ', description: 'Momentum King' },
            { id: 'range_master', name: 'Range Master Pro', emoji: 'üìä', description: 'Range Expert' },
            { id: 'institutional_follower', name: 'Institutional Follower Elite', emoji: 'üèõÔ∏è', description: 'Big Money' }
        ];

        let strategyData = {};
        let refreshInterval;

        async function loadStrategiesData() {
            try {
                // Simulate loading paper trading data
                // In production, this would call your backend API
                const response = await fetch('/api/v1/paper-trading/stats');
                const data = await response.json();
                
                // For now, generate mock data
                strategyData = generateMockData();
                
                renderSummary();
                renderStrategies();
                updateLastUpdate();
            } catch (error) {
                console.error('Error loading data:', error);
                // Generate mock data as fallback
                strategyData = generateMockData();
                renderSummary();
                renderStrategies();
                updateLastUpdate();
            }
        }

        function generateMockData() {
            const data = {};
            strategies.forEach(strategy => {
                const isRunning = Math.random() > 0.3;
                const totalTrades = isRunning ? Math.floor(Math.random() * 50) + 10 : 0;
                const winRate = Math.random() * 40 + 40; // 40-80%
                const winningTrades = Math.floor(totalTrades * (winRate / 100));
                const losingTrades = totalTrades - winningTrades;
                const avgWin = Math.random() * 50 + 20;
                const avgLoss = Math.random() * 30 + 10;
                const totalProfit = (winningTrades * avgWin) - (losingTrades * avgLoss);
                const returnPercent = (totalProfit / 1000) * 100;
                const maxDrawdown = Math.random() * 15 + 5;
                const profitFactor = losingTrades > 0 ? (winningTrades * avgWin) / (losingTrades * avgLoss) : 0;

                data[strategy.id] = {
                    isRunning,
                    totalTrades,
                    winningTrades,
                    losingTrades,
                    winRate: winRate.toFixed(1),
                    profitFactor: profitFactor.toFixed(2),
                    totalProfit: totalProfit.toFixed(2),
                    returnPercent: returnPercent.toFixed(2),
                    maxDrawdown: maxDrawdown.toFixed(2),
                    currentBalance: (1000 + totalProfit).toFixed(2),
                    avgWin: avgWin.toFixed(2),
                    avgLoss: avgLoss.toFixed(2),
                    lastTrade: isRunning ? new Date(Date.now() - Math.random() * 3600000).toLocaleTimeString() : 'N/A'
                };
            });
            return data;
        }

        function renderSummary() {
            const runningStrategies = Object.values(strategyData).filter(s => s.isRunning).length;
            const totalTrades = Object.values(strategyData).reduce((sum, s) => sum + s.totalTrades, 0);
            const avgWinRate = Object.values(strategyData).reduce((sum, s) => sum + parseFloat(s.winRate), 0) / strategies.length;
            const totalProfit = Object.values(strategyData).reduce((sum, s) => sum + parseFloat(s.totalProfit), 0);
            const bestStrategy = Object.entries(strategyData).sort((a, b) => parseFloat(b[1].returnPercent) - parseFloat(a[1].returnPercent))[0];

            const summaryHTML = `
                <div class="summary-card">
                    <h3>Running Strategies</h3>
                    <div class="value">${runningStrategies}/10</div>
                </div>
                <div class="summary-card">
                    <h3>Total Trades</h3>
                    <div class="value">${totalTrades}</div>
                </div>
                <div class="summary-card">
                    <h3>Avg Win Rate</h3>
                    <div class="value">${avgWinRate.toFixed(1)}%</div>
                </div>
                <div class="summary-card">
                    <h3>Total P/L</h3>
                    <div class="value ${totalProfit >= 0 ? 'positive' : 'negative'}">
                        ${totalProfit >= 0 ? '+' : ''}$${totalProfit.toFixed(2)}
                    </div>
                </div>
                <div class="summary-card">
                    <h3>Best Strategy</h3>
                    <div class="value" style="font-size: 1.2em;">
                        ${strategies.find(s => s.id === bestStrategy[0])?.emoji || 'üèÜ'}
                    </div>
                </div>
            `;

            document.getElementById('summary').innerHTML = summaryHTML;
        }

        function renderStrategies() {
            const sortedStrategies = strategies.sort((a, b) => {
                const aReturn = parseFloat(strategyData[a.id]?.returnPercent || 0);
                const bReturn = parseFloat(strategyData[b.id]?.returnPercent || 0);
                return bReturn - aReturn;
            });

            const bestStrategyId = sortedStrategies[0].id;

            const html = sortedStrategies.map((strategy, index) => {
                const data = strategyData[strategy.id] || {};
                const isBest = strategy.id === bestStrategyId && parseFloat(data.returnPercent) > 0;
                
                return `
                    <div class="strategy-card ${isBest ? 'best' : ''}" id="card-${strategy.id}">
                        <div class="strategy-header">
                            <h2>
                                <span class="emoji">${strategy.emoji}</span>
                                ${strategy.name}
                            </h2>
                            <div class="description">${strategy.description}</div>
                        </div>
                        <div class="strategy-body">
                            <div class="metric-row">
                                <span class="metric-label">Status</span>
                                <span class="metric-value">
                                    <span class="status-badge ${data.isRunning ? 'running' : 'stopped'}">
                                        ${data.isRunning ? 'üü¢ Running' : '‚ö™ Stopped'}
                                    </span>
                                </span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Current Balance</span>
                                <span class="metric-value ${parseFloat(data.currentBalance) >= 1000 ? 'positive' : 'negative'}">
                                    $${data.currentBalance || '1000.00'}
                                </span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">P/L</span>
                                <span class="metric-value ${parseFloat(data.totalProfit) >= 0 ? 'positive' : 'negative'}">
                                    ${parseFloat(data.totalProfit) >= 0 ? '+' : ''}$${data.totalProfit || '0.00'}
                                    (${parseFloat(data.returnPercent) >= 0 ? '+' : ''}${data.returnPercent || '0.00'}%)
                                </span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Total Trades</span>
                                <span class="metric-value">${data.totalTrades || 0}</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Win Rate</span>
                                <span class="metric-value">${data.winRate || '0.0'}% (${data.winningTrades || 0}W / ${data.losingTrades || 0}L)</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Profit Factor</span>
                                <span class="metric-value ${parseFloat(data.profitFactor) > 1 ? 'positive' : 'negative'}">
                                    ${data.profitFactor || '0.00'}x
                                </span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Max Drawdown</span>
                                <span class="metric-value negative">${data.maxDrawdown || '0.00'}%</span>
                            </div>
                            <div class="metric-row">
                                <span class="metric-label">Last Trade</span>
                                <span class="metric-value">${data.lastTrade || 'N/A'}</span>
                            </div>
                            
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${data.winRate || 0}%"></div>
                            </div>
                            
                            <div class="action-buttons">
                                <button class="btn-start" onclick="startStrategy('${strategy.id}')">
                                    ${data.isRunning ? '‚úÖ Running' : '‚ñ∂Ô∏è Start'}
                                </button>
                                <button class="btn-stop" onclick="stopStrategy('${strategy.id}')">‚èπÔ∏è Stop</button>
                                <button class="btn-details" onclick="viewDetails('${strategy.id}')">üìä Details</button>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('strategiesGrid').innerHTML = html;
        }

        function updateLastUpdate() {
            const now = new Date().toLocaleTimeString();
            document.getElementById('lastUpdate').innerHTML = `
                <span class="live-indicator"></span>
                Last updated: ${now}
            `;
        }

        async function startStrategy(strategyId) {
            alert(`Starting ${strategyId} paper trading...`);
            // In production: await fetch('/api/v1/paper-trading/start', { method: 'POST', body: JSON.stringify({ strategy: strategyId }) });
            strategyData[strategyId].isRunning = true;
            renderStrategies();
        }

        async function stopStrategy(strategyId) {
            alert(`Stopping ${strategyId}...`);
            // In production: await fetch('/api/v1/paper-trading/stop', { method: 'POST', body: JSON.stringify({ strategy: strategyId }) });
            strategyData[strategyId].isRunning = false;
            renderStrategies();
        }

        async function startAllStrategies() {
            if (confirm('Start paper trading for all 10 strategies?')) {
                strategies.forEach(s => {
                    strategyData[s.id].isRunning = true;
                });
                renderSummary();
                renderStrategies();
                alert('All strategies started! Monitor performance in real-time.');
            }
        }

        async function stopAllStrategies() {
            if (confirm('Stop all running strategies?')) {
                strategies.forEach(s => {
                    strategyData[s.id].isRunning = false;
                });
                renderSummary();
                renderStrategies();
            }
        }

        function viewDetails(strategyId) {
            const strategy = strategies.find(s => s.id === strategyId);
            const data = strategyData[strategyId];
            alert(`${strategy.emoji} ${strategy.name}\n\nDetailed Stats:\n` +
                  `Current Balance: $${data.currentBalance}\n` +
                  `Total P/L: $${data.totalProfit} (${data.returnPercent}%)\n` +
                  `Win Rate: ${data.winRate}%\n` +
                  `Profit Factor: ${data.profitFactor}x\n` +
                  `Max Drawdown: ${data.maxDrawdown}%\n` +
                  `Avg Win: $${data.avgWin}\n` +
                  `Avg Loss: $${data.avgLoss}\n\n` +
                  `Ready for live trading: ${parseFloat(data.returnPercent) > 10 && parseFloat(data.winRate) > 55 ? 'YES ‚úÖ' : 'Not yet ‚ö†Ô∏è'}`);
        }

        function refreshData() {
            loadStrategiesData();
        }

        // Auto-refresh every 10 seconds
        function startAutoRefresh() {
            refreshInterval = setInterval(() => {
                loadStrategiesData();
            }, 10000);
        }

        // Initialize
        loadStrategiesData();
        startAutoRefresh();
    </script>
</body>
</html>
